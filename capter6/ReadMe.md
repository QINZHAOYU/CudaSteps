# CUDA 的内存组织

< CPU >   
// ----------------------------------------------------------------------------------  
// 内存  
// ----------------------------------------------------------------------------------  
        ||  
        ||  
< GPU > ||  
// ----------------------------------------------------------------------------------  
// 全局内存  
// ----------------------------------------------------------------------------------  
        ||  
// ----------------------------------------------------------------------------------   
// 纹理内存  
// ----------------------------------------------------------------------------------  
        ||  
// ----------------------------------------------------------------------------------  
// 常量内存  
// ----------------------------------------------------------------------------------  
        ||                                                 ||  
// ---------------------------------------         // -------------------------------  
// 共享内存 [block0]                                // 共享内存 [block1]                  
// ---------------------------------------         // -------------------------------  
        ||                           ||  
// -----------------------    // -----------------------  
// 局部内存 [thread00]         // 局部内存 [thread01]            ......  
// 寄存器                      // 寄存器  
// -----------------------    // -----------------------  

------

## CUDA 中不同类型的内存

1. **全局内存（global memory）**，即核函数中所有线程都可以访问的内存，可读可写，由主机端分配和释放；  
如 cudaMalloc() 的设备内存 d_x, d_y, d_z。

全局内存由于没有放到 GPU 芯片上，所以具有较高的延迟和较低的访问速度，但是容量大（显存）。  
全局内存主要为核函数提供数据，并在主机和设备、设备和设备之间传递数据。

全局内存的生命周期由主机端维护，期间不同的核函数可以多次访问全局内存。

除以上动态分配的全局内存变量外，还可以使用 **静态全局内存变量**，其所占内存数量在编译器确定；  
这样的静态全局内存变量必须在 所有主机和设备函数外部定义，例如：  

```cuda  
    __device__ real epsilon;  // 单个静态全局内存变量， `__device` 表示是设备中的变量。
    __device__ real arr[10];  // 固定长度的静态全局内存数组变量。
```

对于静态全局内存变量，其访问权限：  

1. 核函数中可以直接访问静态全局内存变量，不必以参数形式传给核函数；
2. 主机中不可以直接访问静态全局内存变量，可以通过 `cudaMemcpyToSymbol()` 和 `cudaMemcpyFromSymbol()` 调用。


